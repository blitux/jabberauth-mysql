/*
YAV: Yet Another Validation tool
http://yav.sourceforge.net/
Yav is licensed under the LGPL license, therefore you can use it in both commercial and open-source projects.
*/
var yav={undef:undefined,isFocusSet:undefined,internalRules:undefined,f:undefined,formEvt:undefined,fieldsEvt:new Array(),rulesEvt:new Array(),helpEvt:new Array(),mask:new Array(),onOKEvt:new Array(),onErrorEvt:new Array(),preValidationEvt:new Array(),filterByName:null,performCheck:function(formName,strRules,alertType,filterErrorsByName){yav.filterByName=(filterErrorsByName)?filterErrorsByName:null;for(var j=0;j<yav.preValidationEvt.length;j++){if(yav.filterByName==yav.preValidationEvt[j].name){var preValidationResult=eval(yav.preValidationEvt[j].fn);yav.preValidationEvt[j].executedWithSuccess=preValidationResult;if(!preValidationResult){return preValidationResult}break}}yav.isFocusSet=false;var rules=yav.makeRules(strRules);yav.internalRules=yav.makeRules(strRules);yav.f=document.forms[formName];if(!yav.f){yav.debug("DEBUG: could not find form object "+formName);return null}var errors=new Array();var ix=0;if(rules.length){for(var i=0;i<rules.length;i++){var aRule=rules[i];if(aRule!=null){yav.highlight(yav.getField(yav.f,aRule.el),yav_config.inputclassnormal)}}}else{if(rules!=null){yav.highlight(yav.getField(yav.f,rules.el),yav_config.inputclassnormal)}}if(rules.length){for(var i=0;i<rules.length;i++){var aRule=rules[i];var anErr=null;if(aRule==null){}else{if(aRule.ruleType=="pre-condition"||aRule.ruleType=="post-condition"||aRule.ruleType=="andor-operator"){}else{if(aRule.ruleName=="implies"){pre=aRule.el;post=aRule.comparisonValue;var oldClassName=yav.getField(yav.f,rules[pre].el).className;if(yav.filterByName!=null){if(rules[pre].el==yav.filterByName||rules[post].el==yav.filterByName){yav.clearInlineSpans(rules[pre].el,rules[post].el)}}if(yav.checkRule(yav.f,rules[pre])==null&&yav.checkRule(yav.f,rules[post])!=null){anErr=yav.deleteInline(aRule.alertMsg)+"__inline__"+rules[post].el}else{if(yav.checkRule(yav.f,rules[pre])!=null){yav.getField(yav.f,rules[pre].el).className=oldClassName}}}else{if(aRule.ruleName=="date_lt"||aRule.ruleName=="date_le"){if(yav.filterByName!=null){if(aRule.comparisonValue&&aRule.comparisonValue.indexOf("$"+yav.filterByName)==0){yav.clearInlineSpans(aRule.el,yav.filterByName)}}anErr=yav.checkRule(yav.f,aRule)}else{anErr=yav.checkRule(yav.f,aRule)}}}}if(anErr!=null){if(yav.filterByName&&yav.filterByName!=null){if(aRule.ruleName=="implies"){if(rules[pre].el==yav.filterByName||rules[post].el==yav.filterByName){yav.clearInlineSpans(rules[pre].el,rules[post].el)}aRule=rules[aRule.comparisonValue]}if(aRule.ruleName=="or"){var tmp=aRule.comparisonValue.split("-");for(var t=0;t<tmp.length;t++){yav.clearInlineSpans(rules[tmp[t]].el)}if(rules[aRule.el].el==yav.filterByName){yav.clearInlineSpans(rules[aRule.el].el)}aRule=rules[aRule.el]}if(aRule.el==yav.filterByName||(aRule.comparisonValue&&aRule.comparisonValue.indexOf("$"+yav.filterByName)==0)){for(var z=0;z<rules.length;z++){if(rules[z].ruleName=="implies"&&rules[rules[z].el].el==aRule.el){yav.clearInlineSpans(rules[rules[z].comparisonValue].el)}}errors[ix]=anErr;ix++;break}}else{errors[ix]=anErr;ix++}}}}else{var myRule=rules;err=yav.checkRule(yav.f,myRule);if(err!=null){if(yav.filterByName&&yav.filterByName!=null){if(myRule.el==yav.filterByName){errors[0]=err}}else{errors[0]=err}}}var retval=yav.displayAlert(errors,alertType);yav.filterByName=null;return retval},checkKeyPress:function(e,g,a){var f=null;f=(typeof(e.which))!="undefined"?e.which:window.event.keyCode;var h=yav.makeRules(a);var b=true;if(h.length){for(var d=0;d<h.length;d++){var c=h[d];if(c.ruleName=="keypress"&&c.el==g.name){b=yav.isKeyAllowed(f,c.comparisonValue);break}}}else{var c=h;if(c.ruleName=="keypress"&&c.el==g.name){b=yav.isKeyAllowed(f,c.comparisonValue)}}if(!b){if(typeof(e.which)=="undefined"){window.event.keyCode=0}else{e.preventDefault();e.stopPropagation();e.returnValue=false}}return b},init:function(e,a){yav.addMask("alphabetic",null,null,yav_config.alphabetic_regex);yav.addMask("alphanumeric",null,null,yav_config.alphanumeric_regex);yav.addMask("alnumhyphen",null,null,yav_config.alnumhyphen_regex);yav.addMask("alnumhyphenat",null,null,yav_config.alnumhyphenat_regex);yav.addMask("alphaspace",null,null,yav_config.alphaspace_regex);yav.formEvt=e;yav.rulesEvt=a;if(a.length){for(var d=0;d<a.length;d++){var c=yav.splitRule(a[d]);var h=yav.getField(document.forms[e],c.el);if(h&&c.ruleName=="mask"){yav.addEvent(h,"keypress",yav.maskEvt.bindAsEventListener(h))}else{if(h&&!yav.inArray(yav.fieldsEvt,c.el)){var f=false;for(var b=0;b<yav.onOKEvt.length;b++){if(h.name==yav.onOKEvt[b].name){yav.addEvent(h,yav.onOKEvt[b].evType,function(){if(yav.performEvt(this.name)){yav.performOnOKEvt(this.name)}else{for(var i=0;i<yav.preValidationEvt.length;i++){if(this.name==yav.preValidationEvt[i].name){if(yav.preValidationEvt[i].executedWithSuccess==false){yav.preValidationEvt[i].executedWithSuccess=null;return}yav.preValidationEvt[i].executedWithSuccess=null;break}}yav.performOnErrorEvt(this.name)}});f=true;break}}if(!f){for(var b=0;b<yav.onErrorEvt.length;b++){if(h.name==yav.onErrorEvt[b].name){yav.addEvent(h,yav.onErrorEvt[b].evType,function(){if(!yav.performEvt(this.name)){for(var i=0;i<yav.preValidationEvt.length;i++){if(this.name==yav.preValidationEvt[i].name){if(yav.preValidationEvt[i].executedWithSuccess==false){yav.preValidationEvt[i].executedWithSuccess=null;return}yav.preValidationEvt[i].executedWithSuccess=null;break}}yav.performOnErrorEvt(this.name)}});f=true;break}}}yav.fieldsEvt.push(c.el);if(!f){yav.addEvent(h,"blur",function(){yav.performEvt(this.name)})}}}}}else{var g=yav.splitRule(a);var h=yav.getField(document.forms[e],g.el);if(h&&g.ruleName=="mask"){yav.addEvent(h,"keypress",yav.maskEvt.bindAsEventListener(h))}else{if(h){var f=false;for(var b=0;d<yav.onOKEvt.length;b++){if(h.name==yav.onOKEvt[d].name){yav.addEvent(h,yav.onOKEvt[b].evType,function(){if(yav.performEvt(this.name)){yav.performOnOKEvt(this.name)}});f=true;break}}for(var b=0;b<yav.onErrorEvt.length;b++){if(h.name==yav.onErrorEvt[b].name){yav.addEvent(h,yav.onErrorEvt[b].evType,function(){if(!yav.performEvt(this.name)){for(var i=0;i<yav.preValidationEvt.length;i++){if(this.name==yav.preValidationEvt[i].name){if(yav.preValidationEvt[i].executedWithSuccess==false){yav.preValidationEvt[i].executedWithSuccess=null;return}yav.preValidationEvt[i].executedWithSuccess=null;break}}yav.performOnErrorEvt(this.name)}});f=true;break}}if(!f){yav.addEvent(h,"blur",function(){yav.performEvt(this.name)})}}}}if(yav.helpEvt.length>0){for(var d=0;d<yav.helpEvt.length;d++){var h=yav.getField(document.forms[e],yav.helpEvt[d].name);if(h){if(h.focus){yav.addEvent(h,"focus",function(){yav.showHelpEvt(this.name)})}else{yav.addEvent(h,"click",function(){yav.showHelpEvt(this.name)})}if(!yav.inArray(yav.fieldsEvt,yav.helpEvt[d].name)){yav.addEvent(h,"blur",function(){yav.cleanInline(this.name)})}}}}},displayMsg:function(b,c,a){var d=yav.get(yav_config.errorsdiv+"_"+b);if(d){d.innerHTML=c;d.className=a;d.style.display=""}else{d=yav.get(yav_config.errorsdiv);if(d){d.innerHTML=c;d.className=a;d.style.display=""}else{alert(c)}}},cleanInline:function(a){yav.get(yav_config.errorsdiv+"_"+a).innerHTML="";yav.get(yav_config.errorsdiv+"_"+a).className="";yav.get(yav_config.errorsdiv+"_"+a).style.display="none"},addHelp:function(a,c){var b=new Object();b.name=a;b.help=c;yav.helpEvt.push(b)},addMask:function(b,e,a,d){var c=new Object();c.name=b;c.format=e;c.charsAllowed=a;c.regex=d?d:null;yav.mask.push(c)},postValidation_OnOK:function(a,d,b){var c=new Object();c.name=a;c.evType=d;c.fn=b;yav.onOKEvt.push(c)},postValidation_OnError:function(a,d,b){var c=new Object();c.name=a;c.evType=d;c.fn=b;yav.onErrorEvt.push(c)},preValidation:function(b,a){var c=new Object();c.name=(a&&a!=null)?a:null;c.fn=b;c.executedWithSuccess=null;yav.preValidationEvt.push(c)},inArray:function(a,d){var c=false;for(var b=0;b<a.length;b++){if(a[b]==d){c=true;break}}return c},performEvt:function(a){var b=yav.get(yav_config.errorsdiv);if(b){b.innerHTML="";b.className="";b.style.display="none"}return yav.performCheck(yav.formEvt,yav.rulesEvt,"inline",a)},performOnOKEvt:function(name){for(var j=0;j<yav.onOKEvt.length;j++){if(name==yav.onOKEvt[j].name){eval(yav.onOKEvt[j].fn);break}}},performOnErrorEvt:function(name){for(var j=0;j<yav.onErrorEvt.length;j++){if(name==yav.onErrorEvt[j].name){eval(yav.onErrorEvt[j].fn);break}}},showHelpEvt:function(a){for(var b=0;b<yav.helpEvt.length;b++){if(yav.helpEvt[b].name==a){yav.get(yav_config.errorsdiv+"_"+a).innerHTML=yav.helpEvt[b].help;yav.get(yav_config.errorsdiv+"_"+a).className=yav_config.innerhelp;yav.get(yav_config.errorsdiv+"_"+a).style.display="";break}}},maskEvt:function(k){var n=null;var m=null;for(var d=0;d<yav.rulesEvt.length;d++){var f=yav.splitRule(yav.rulesEvt[d]);var e=yav.getField(document.forms[yav.formEvt],f.el);if(e&&f.ruleName=="mask"&&e.name==this.name){for(var c=0;c<yav.mask.length;c++){if(yav.mask[c].name==f.comparisonValue){n=yav.mask[c];break}}m=f;break}}var l=(typeof(k.which))!="undefined"?k.which:window.event.keyCode;var a=String.fromCharCode(l);var g=this.value+a;var h=g.length;if(l==8||l==0){return true}var b=false;if(n==null){if(yav.isKeyAllowed(l,m.comparisonValue)){b=true}else{if(typeof(k.which)=="undefined"){window.event.keyCode=0}else{k.preventDefault();k.stopPropagation();k.returnValue=false}}return b}else{if(n.format==null){reg=new RegExp(n.regex);if(reg.test(a)){b=true}else{if(typeof(k.which)=="undefined"){window.event.keyCode=0}else{k.preventDefault();k.stopPropagation();k.returnValue=false}}return b}else{if(yav.isKeyAllowed(l,n.charsAllowed)&&h<=n.format.length){if(n.format.charAt(h-1)!=" "){g=this.value+n.format.charAt(h-1)+a}this.value=g;b=true}}}if(typeof(k.which)=="undefined"){window.event.keyCode=0}else{k.preventDefault();k.stopPropagation();k.returnValue=false}return b},displayAlert:function(c,b){var a=null;yav.clearAllInlineSpans();if(b=="classic"){a=yav.displayClassic(c)}else{if(b=="innerHtml"){a=yav.displayInnerHtml(c)}else{if(b=="inline"){a=yav.displayInline(c)}else{if(b=="jsVar"){a=yav.displayJsVar(c)}else{yav.debug("DEBUG: alert type "+b+" not supported")}}}}return a},displayClassic:function(b){var c="";if(b!=null&&b.length>0){if(yav.strTrim(yav_config.HEADER_MSG).length>0){c+=yav_config.HEADER_MSG+"\n\n"}for(var a=0;a<b.length;a++){c+=" "+yav.deleteInline(b[a])+"\n"}if(yav.strTrim(yav_config.FOOTER_MSG).length>0){c+="\n"+yav_config.FOOTER_MSG}alert(c);return false}else{return true}},displayInnerHtml:function(b){if(b!=null&&b.length>0){var c="";if(yav.strTrim(yav_config.HEADER_MSG).length>0){c+=yav_config.HEADER_MSG}c+="<ul>";for(var a=0;a<b.length;a++){c+="<li>"+yav.deleteInline(b[a])+"</li>"}c+="</ul>";if(yav.strTrim(yav_config.FOOTER_MSG).length>0){c+=yav_config.FOOTER_MSG}yav.get(yav_config.errorsdiv).innerHTML=c;yav.get(yav_config.errorsdiv).className=yav_config.innererror;yav.get(yav_config.errorsdiv).style.display="block";return false}else{yav.get(yav_config.errorsdiv).innerHTML="";yav.get(yav_config.errorsdiv).className="";yav.get(yav_config.errorsdiv).style.display="none";return true}},displayInline:function(c){if(c!=null&&c.length>0){var a=new Array();var d=0;for(var b=0;b<c.length;b++){var e=c[b].substring(c[b].indexOf("__inline__")+10);if(yav.get(yav_config.errorsdiv+"_"+e)){yav.get(yav_config.errorsdiv+"_"+e).innerHTML=yav.deleteInline(c[b]);yav.get(yav_config.errorsdiv+"_"+e).className=yav_config.innererror;yav.get(yav_config.errorsdiv+"_"+e).style.display=""}else{a[d]=c[b];d++}}if(d>0){yav.displayInnerHtml(a)}return false}else{return true}},clearAllInlineSpans:function(){var c=document.getElementsByTagName("span");for(var b=0;b<c.length;b++){var a=c[b].id;if(a.indexOf(yav_config.errorsdiv+"_")==0){if(yav.filterByName!=null){if(a==yav_config.errorsdiv+"_"+yav.filterByName){yav.get(a).innerHTML="";yav.get(a).className="";yav.get(a).style.display="none"}}else{yav.get(a).innerHTML="";yav.get(a).className="";yav.get(a).style.display="none"}}}},clearInlineSpans:function(){var d=document.getElementsByTagName("span");for(var c=0;c<d.length;c++){var b=d[c].id;if(b.indexOf(yav_config.errorsdiv+"_")==0){for(var a=0;a<arguments.length;a++){if(b==yav_config.errorsdiv+"_"+arguments[a]){yav.get(b).innerHTML="";yav.get(b).className="";yav.get(b).style.display="none"}}}}},displayJsVar:function(b){yav.get(yav_config.errorsdiv).className="";yav.get(yav_config.errorsdiv).style.display="none";if(b!=null&&b.length>0){for(var a=0;a<b.length;a++){b[a]=yav.deleteInline(b[a])}var c="";c+="<script>var jsErrors;<\/script>";yav.get(yav_config.errorsdiv).innerHTML=c;jsErrors=b;return false}else{yav.get(yav_config.errorsdiv).innerHTML="<script>var jsErrors;<\/script>";return true}},rule:function(b,e,d,a,f){var c=arguments.length>=4&&arguments[0]!=null&&arguments[1]!=null;if(!c){return false}tmp=b.split(":");nameDisplayed="";if(tmp.length==2){nameDisplayed=tmp[1];b=tmp[0]}this.el=b;this.nameDisplayed=nameDisplayed;this.ruleName=e;this.comparisonValue=d;this.ruleType=f;if(a==yav.undef||a==null){this.alertMsg=yav.getDefaultMessage(b,nameDisplayed,e,d)+"__inline__"+this.el}else{this.alertMsg=a+"__inline__"+this.el}},checkRule:function(f,myRule){retVal=null;if(myRule!=null){if(myRule.ruleName=="custom"){var customFunction=null;if(myRule.comparisonValue!=null){customFunction=" retVal = "+myRule.comparisonValue}else{customFunction=" retVal = "+myRule.el}retVal=eval(customFunction);if(myRule.comparisonValue!=null&&retVal!=this.undef&&retVal!=null){retVal+="__inline__"+myRule.el}if(retVal!=null&&myRule.comparisonValue!=null){yav.highlight(yav.getField(yav.f,myRule.el),yav_config.inputclasserror)}}else{if(myRule.ruleName=="and"){var op_1=myRule.el;var op_next=myRule.comparisonValue;if(yav.checkRule(f,yav.internalRules[op_1])!=null){retVal=myRule.alertMsg;if(myRule.ruleType=="pre-condition"||myRule.ruleType=="andor-operator"){}}else{var op_k=op_next.split("-");for(var k=0;k<op_k.length;k++){if(yav.checkRule(f,yav.internalRules[op_k[k]])!=null){retVal=myRule.alertMsg;if(myRule.ruleType=="pre-condition"||myRule.ruleType=="andor-operator"){}break}}}}else{if(myRule.ruleName=="or"){var op_1=myRule.el;var op_next=myRule.comparisonValue;var success=false;if(yav.checkRule(f,yav.internalRules[op_1])==null){success=true}else{if(myRule.ruleType=="pre-condition"||myRule.ruleType=="andor-operator"){}var op_k=op_next.split("-");for(var k=0;k<op_k.length;k++){if(yav.checkRule(f,yav.internalRules[op_k[k]])==null){success=true;break}else{if(myRule.ruleType=="pre-condition"||myRule.ruleType=="andor-operator"){}}}}if(success){yav.highlight(yav.getField(f,yav.internalRules[op_1].el),yav_config.inputclassnormal);var op_k=op_next.split("-");for(var k=0;k<op_k.length;k++){yav.highlight(yav.getField(f,yav.internalRules[op_k[k]].el),yav_config.inputclassnormal)}}else{retVal=myRule.alertMsg}}else{el=yav.getField(f,myRule.el);if(el==null){yav.debug("DEBUG: could not find element "+myRule.el);return null}var err=null;if(el.type){if(el.type=="hidden"||el.type=="text"||el.type=="password"||el.type=="textarea"){err=yav.checkText(el,myRule)}else{if(el.type=="checkbox"){err=yav.checkCheckbox(el,myRule)}else{if(el.type=="select-one"){err=yav.checkSelOne(el,myRule)}else{if(el.type=="select-multiple"){err=yav.checkSelMul(el,myRule)}else{if(el.type=="radio"){err=yav.checkRadio(el,myRule)}else{yav.debug("DEBUG: type "+el.type+" not supported")}}}}}}else{err=yav.checkRadio(el,myRule)}retVal=err}}}}return retVal},checkRadio:function(b,e){var c=null;if(e.ruleName=="required"){var f=b;var d=false;if(isNaN(f.length)&&f.checked){d=true}else{for(var a=0;a<f.length;a++){if(f[a].checked){d=true;break}}}if(!d){yav.highlight(b,yav_config.inputclasserror);c=e.alertMsg}}else{if(e.ruleName=="equal"){var f=b;var d=false;if(isNaN(f.length)&&f.checked){if(f.value==e.comparisonValue){d=true}}else{for(var a=0;a<f.length;a++){if(f[a].checked){if(f[a].value==e.comparisonValue){d=true;break}}}}if(!d){c=e.alertMsg}}else{if(e.ruleName=="notequal"){var f=b;var d=false;if(isNaN(f.length)&&f.checked){if(f.value!=e.comparisonValue){d=true}}else{for(var a=0;a<f.length;a++){if(f[a].checked){if(f[a].value!=e.comparisonValue){d=true;break}}}}if(!d){c=e.alertMsg}}else{yav.debug("DEBUG: rule "+e.ruleName+" not supported for radio")}}}return c},checkText:function(el,myRule){err=null;if(yav_config.trimenabled){el.value=yav.strTrim(el.value)}if(myRule.ruleName=="required"){if(el.value==null||el.value==""){yav.highlight(el,yav_config.inputclasserror);err=myRule.alertMsg}}else{if(myRule.ruleName=="equal"){err=yav.checkEqual(el,myRule)}else{if(myRule.ruleName=="notequal"){err=yav.checkNotEqual(el,myRule)}else{if(myRule.ruleName=="numeric"){reg=new RegExp("^[0-9]*$");if(!reg.test(el.value)){yav.highlight(el,yav_config.inputclasserror);err=myRule.alertMsg}}else{if(myRule.ruleName=="alphabetic"){reg=new RegExp(yav_config.alphabetic_regex);if(!reg.test(el.value)){yav.highlight(el,yav_config.inputclasserror);err=myRule.alertMsg}}else{if(myRule.ruleName=="alphanumeric"){reg=new RegExp(yav_config.alphanumeric_regex);if(!reg.test(el.value)){yav.highlight(el,yav_config.inputclasserror);err=myRule.alertMsg}}else{if(myRule.ruleName=="alnumhyphen"){reg=new RegExp(yav_config.alnumhyphen_regex);if(!reg.test(el.value)){yav.highlight(el,yav_config.inputclasserror);err=myRule.alertMsg}}else{if(myRule.ruleName=="alnumhyphenat"){reg=new RegExp(yav_config.alnumhyphenat_regex);if(!reg.test(el.value)){yav.highlight(el,yav_config.inputclasserror);err=myRule.alertMsg}}else{if(myRule.ruleName=="alphaspace"){reg=new RegExp(yav_config.alphaspace_regex);if(!reg.test(el.value)){yav.highlight(el,yav_config.inputclasserror);err=myRule.alertMsg}}else{if(myRule.ruleName=="email"){reg=new RegExp(yav_config.email_regex);if(!reg.test(el.value)){yav.highlight(el,yav_config.inputclasserror);err=myRule.alertMsg}}else{if(myRule.ruleName=="maxlength"){if(isNaN(myRule.comparisonValue)){yav.debug("DEBUG: comparisonValue for rule "+myRule.ruleName+" not a number")}else{if(el.value.length>myRule.comparisonValue){yav.highlight(el,yav_config.inputclasserror);err=myRule.alertMsg}}}else{if(myRule.ruleName=="minlength"){if(isNaN(myRule.comparisonValue)){yav.debug("DEBUG: comparisonValue for rule "+myRule.ruleName+" not a number")}else{if(el.value.length<myRule.comparisonValue){yav.highlight(el,yav_config.inputclasserror);err=myRule.alertMsg}}}else{if(myRule.ruleName=="numrange"){reg=new RegExp("^[-+]{0,1}[0-9]*[.]{0,1}[0-9]*$");if(!reg.test(yav.unformatNumber(el.value))){yav.highlight(el,yav_config.inputclasserror);err=myRule.alertMsg}else{regRange=new RegExp("^[0-9]+-[0-9]+$");if(!regRange.test(myRule.comparisonValue)){yav.debug("DEBUG: comparisonValue for rule "+myRule.ruleName+" not in format number1-number2")}else{rangeVal=myRule.comparisonValue.split("-");if(eval(yav.unformatNumber(el.value))<eval(rangeVal[0])||eval(yav.unformatNumber(el.value))>eval(rangeVal[1])){yav.highlight(el,yav_config.inputclasserror);err=myRule.alertMsg}}}}else{if(myRule.ruleName=="regexp"){reg=new RegExp(myRule.comparisonValue);if(!reg.test(el.value)){yav.highlight(el,yav_config.inputclasserror);err=myRule.alertMsg}}else{if(myRule.ruleName=="integer"){err=yav.checkInteger(el,myRule)}else{if(myRule.ruleName=="double"){err=yav.checkDouble(el,myRule)}else{if(myRule.ruleName=="date"){err=yav.checkDate(el,myRule)}else{if(myRule.ruleName=="date_lt"){err=yav.checkDateLessThan(el,myRule,false)}else{if(myRule.ruleName=="date_le"){err=yav.checkDateLessThan(el,myRule,true)}else{if(myRule.ruleName=="keypress"){}else{if(myRule.ruleName=="empty"){if(el.value!=null&&el.value!=""){yav.highlight(el,yav_config.inputclasserror);err=myRule.alertMsg}}else{yav.debug("DEBUG: rule "+myRule.ruleName+" not supported for "+el.type)}}}}}}}}}}}}}}}}}}}}}return err},checkInteger:function(a,b){reg=new RegExp("^[-+]{0,1}[0-9]*$");if(!reg.test(a.value)){yav.highlight(a,yav_config.inputclasserror);return b.alertMsg}},checkDouble:function(b,c){var a=yav_config.DECIMAL_SEP;reg=new RegExp("^[-+]{0,1}[0-9]*["+a+"]{0,1}[0-9]*$");if(!reg.test(b.value)){yav.highlight(b,yav_config.inputclasserror);return c.alertMsg}},checkDate:function(b,c){error=null;if(b.value!=""){var a=yav_config.DATE_FORMAT;ddReg=new RegExp("dd");MMReg=new RegExp("MM");yyyyReg=new RegExp("yyyy");if(!ddReg.test(a)||!MMReg.test(a)||!yyyyReg.test(a)){yav.debug("DEBUG: locale format "+a+" not supported")}else{ddStart=a.indexOf("dd");MMStart=a.indexOf("MM");yyyyStart=a.indexOf("yyyy")}strReg=a.replace("dd","[0-9]{2}").replace("MM","[0-9]{2}").replace("yyyy","[0-9]{4}");reg=new RegExp("^"+strReg+"$");if(!reg.test(b.value)){yav.highlight(b,yav_config.inputclasserror);error=c.alertMsg}else{dd=b.value.substring(ddStart,ddStart+2);MM=b.value.substring(MMStart,MMStart+2);yyyy=b.value.substring(yyyyStart,yyyyStart+4);if(!yav.checkddMMyyyy(dd,MM,yyyy)){yav.highlight(b,yav_config.inputclasserror);error=c.alertMsg}}}return error},checkDateLessThan:function(e,f,c){error=null;var b=yav.checkDate(e,f)==null?true:false;if(b&&e.value!=""){var a=yav_config.DATE_FORMAT;ddStart=a.indexOf("dd");MMStart=a.indexOf("MM");yyyyStart=a.indexOf("yyyy");dd=e.value.substring(ddStart,ddStart+2);MM=e.value.substring(MMStart,MMStart+2);yyyy=e.value.substring(yyyyStart,yyyyStart+4);myDate=""+yyyy+MM+dd;strReg=a.replace("dd","[0-9]{2}").replace("MM","[0-9]{2}").replace("yyyy","[0-9]{4}");reg=new RegExp("^"+strReg+"$");var g=f.comparisonValue.indexOf("$")==0?true:false;var d="";if(g){toSplit=f.comparisonValue.substr(1);tmp=toSplit.split(":");if(tmp.length==2){d=yav.getField(yav.f,tmp[0]).value}else{d=yav.getField(yav.f,f.comparisonValue.substr(1)).value}}else{d=f.comparisonValue}if(!reg.test(d)){yav.highlight(e,yav_config.inputclasserror);error=f.alertMsg}else{cdd=d.substring(ddStart,ddStart+2);cMM=d.substring(MMStart,MMStart+2);cyyyy=d.substring(yyyyStart,yyyyStart+4);cDate=""+cyyyy+cMM+cdd;if(c){if(!yav.checkddMMyyyy(cdd,cMM,cyyyy)||myDate>cDate){yav.highlight(e,yav_config.inputclasserror);error=f.alertMsg}}else{if(!yav.checkddMMyyyy(cdd,cMM,cyyyy)||myDate>=cDate){yav.highlight(e,yav_config.inputclasserror);error=f.alertMsg}}}}else{if(e.value!=""){yav.highlight(e,yav_config.inputclasserror);error=f.alertMsg}}return error},checkEqual:function(b,c){error=null;var d=c.comparisonValue.indexOf("$")==0?true:false;var a="";if(d){toSplit=c.comparisonValue.substr(1);tmp=toSplit.split(":");if(tmp.length==2){a=yav.getField(yav.f,tmp[0]).value}else{a=yav.getField(yav.f,c.comparisonValue.substr(1)).value}}else{a=c.comparisonValue}if(b.value!=a){yav.highlight(b,yav_config.inputclasserror);error=c.alertMsg}return error},checkNotEqual:function(b,c){error=null;var d=c.comparisonValue.indexOf("$")==0?true:false;var a="";if(d){toSplit=c.comparisonValue.substr(1);tmp=toSplit.split(":");if(tmp.length==2){a=yav.getField(yav.f,tmp[0]).value}else{a=yav.getField(yav.f,c.comparisonValue.substr(1)).value}}else{a=c.comparisonValue}if(b.value==a){yav.highlight(b,yav_config.inputclasserror);error=c.alertMsg}return error},checkddMMyyyy:function(a,c,b){retVal=true;if((a<1)||(a>31)||(c<1)||(c>12)||(a==31&&(c==2||c==4||c==6||c==9||c==11))||(a>29&&c==2)||(a==29&&(c==2)&&((b%4>0)||(b%4==0&&b%100==0&&b%400>0)))){retVal=false}return retVal},checkCheckbox:function(a,b){if(b.ruleName=="required"){if(!a.checked){yav.highlight(a,yav_config.inputclasserror);return b.alertMsg}}else{if(b.ruleName=="equal"){if(!a.checked||a.value!=b.comparisonValue){yav.highlight(a,yav_config.inputclasserror);return b.alertMsg}}else{if(b.ruleName=="notequal"){if(a.checked&&a.value==b.comparisonValue){yav.highlight(a,yav_config.inputclasserror);return b.alertMsg}}else{yav.debug("DEBUG: rule "+b.ruleName+" not supported for "+a.type)}}}},checkSelOne:function(a,c){if(c.ruleName=="required"){var b=false;var d=a.selectedIndex;if(d>=0&&a.options[d].value){b=true}if(!b){yav.highlight(a,yav_config.inputclasserror);return c.alertMsg}}else{if(c.ruleName=="equal"){var b=false;var d=a.selectedIndex;if(d>=0&&a.options[d].value==c.comparisonValue){b=true}if(!b){yav.highlight(a,yav_config.inputclasserror);return c.alertMsg}}else{if(c.ruleName=="notequal"){var b=false;var d=a.selectedIndex;if(d>=0&&a.options[d].value!=c.comparisonValue){b=true}if(!b){yav.highlight(a,yav_config.inputclasserror);return c.alertMsg}}else{yav.debug("DEBUG: rule "+c.ruleName+" not supported for "+a.type)}}}},checkSelMul:function(b,d){if(d.ruleName=="required"){var c=false;opts=b.options;for(var a=0;a<opts.length;a++){if(opts[a].selected&&opts[a].value){c=true;break}}if(!c){yav.highlight(b,yav_config.inputclasserror);return d.alertMsg}}else{if(d.ruleName=="equal"){var c=false;opts=b.options;for(var a=0;a<opts.length;a++){if(opts[a].selected&&opts[a].value==d.comparisonValue){c=true;break}}if(!c){yav.highlight(b,yav_config.inputclasserror);return d.alertMsg}}else{if(d.ruleName=="notequal"){var c=false;opts=b.options;for(var a=0;a<opts.length;a++){if(opts[a].selected&&opts[a].value!=d.comparisonValue){c=true;break}}if(!c){yav.highlight(b,yav_config.inputclasserror);return d.alertMsg}}else{yav.debug("DEBUG: rule "+d.ruleName+" not supported for "+b.type)}}}},debug:function(a){if(yav_config.debugmode){alert(a)}},strTrim:function(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")},makeRules:function(a){var c=new Array();if(a.length){for(var b=0;b<a.length;b++){c[b]=yav.splitRule(a[b])}}else{c[0]=yav.splitRule(a)}return c},splitRule:function(b){var a=null;if(b!=yav.undef){params=b.split(yav_config.RULE_SEP);switch(params.length){case 2:a=new yav.rule(params[0],params[1],null,null,null);break;case 3:if(yav.threeParamRule(params[1])){a=new yav.rule(params[0],params[1],params[2],null,null)}else{if(params[2]=="pre-condition"||params[2]=="post-condition"||params[2]=="andor-operator"){a=new yav.rule(params[0],params[1],null,"foo",params[2])}else{a=new yav.rule(params[0],params[1],null,params[2],null)}}break;case 4:if(yav.threeParamRule(params[1])&&(params[3]=="pre-condition"||params[3]=="post-condition"||params[3]=="andor-operator")){a=new yav.rule(params[0],params[1],params[2],"foo",params[3])}else{a=new yav.rule(params[0],params[1],params[2],params[3],null)}break;default:yav.debug("DEBUG: wrong definition of rule")}}return a},threeParamRule:function(a){return(a=="equal"||a=="notequal"||a=="minlength"||a=="maxlength"||a=="date_lt"||a=="date_le"||a=="implies"||a=="regexp"||a=="numrange"||a=="keypress"||a=="and"||a=="or"||a=="custom"||a=="mask")?true:false},highlight:function(b,a){if(yav.rulesEvt.length>0&&a==yav_config.inputclasserror){return}if(!yav.isFocusSet&&a==yav_config.inputclasserror){if((!b.type)&&(b.length>0)&&(b.item(0).type=="radio")){b.item(0).focus()}else{b.focus()}yav.isFocusSet=true}if(b!=yav.undef&&yav_config.inputhighlight){if(yav_config.multipleclassname){yav.highlightMultipleClassName(b,a)}else{b.className=a}}},highlightMultipleClassName:function(b,a){re=new RegExp("(^|\\s)("+yav_config.inputclassnormal+"|"+yav_config.inputclasserror+")($|\\s)");b.className=yav.strTrim(((typeof b.className!="undefined")?b.className.replace(re,""):"")+" "+a)},getDefaultMessage:function(b,a,d,c){if(a.length==0){a=b}var e=yav_config.DEFAULT_MSG;if(d=="required"){e=yav_config.REQUIRED_MSG.replace("{1}",a)}else{if(d=="minlength"){e=yav_config.MINLENGTH_MSG.replace("{1}",a).replace("{2}",c)}else{if(d=="maxlength"){e=yav_config.MAXLENGTH_MSG.replace("{1}",a).replace("{2}",c)}else{if(d=="numrange"){e=yav_config.NUMRANGE_MSG.replace("{1}",a).replace("{2}",c)}else{if(d=="date"){e=yav_config.DATE_MSG.replace("{1}",a)}else{if(d=="numeric"){e=yav_config.NUMERIC_MSG.replace("{1}",a)}else{if(d=="integer"){e=yav_config.INTEGER_MSG.replace("{1}",a)}else{if(d=="double"){e=yav_config.DOUBLE_MSG.replace("{1}",a)}else{if(d=="equal"){e=yav_config.EQUAL_MSG.replace("{1}",a).replace("{2}",yav.getComparisonDisplayed(c))}else{if(d=="notequal"){e=yav_config.NOTEQUAL_MSG.replace("{1}",a).replace("{2}",yav.getComparisonDisplayed(c))}else{if(d=="alphabetic"){e=yav_config.ALPHABETIC_MSG.replace("{1}",a)}else{if(d=="alphanumeric"){e=yav_config.ALPHANUMERIC_MSG.replace("{1}",a)}else{if(d=="alnumhyphen"){e=yav_config.ALNUMHYPHEN_MSG.replace("{1}",a)}else{if(d=="alnumhyphenat"){e=yav_config.ALNUMHYPHENAT_MSG.replace("{1}",a)}else{if(d=="alphaspace"){e=yav_config.ALPHASPACE_MSG.replace("{1}",a)}else{if(d=="email"){e=yav_config.EMAIL_MSG.replace("{1}",a)}else{if(d=="regexp"){e=yav_config.REGEXP_MSG.replace("{1}",a).replace("{2}",c)}else{if(d=="date_lt"){e=yav_config.DATE_LT_MSG.replace("{1}",a).replace("{2}",yav.getComparisonDisplayed(c))}else{if(d=="date_le"){e=yav_config.DATE_LE_MSG.replace("{1}",a).replace("{2}",yav.getComparisonDisplayed(c))}else{if(d=="empty"){e=yav_config.EMPTY_MSG.replace("{1}",a)}}}}}}}}}}}}}}}}}}}}return e},getComparisonDisplayed:function(a){comparisonDisplayed=a;if(a.substring(0,1)=="$"){a=a.substring(1,a.length);tmp=a.split(":");if(tmp.length==2){comparisonDisplayed=tmp[1]}else{comparisonDisplayed=a}}return comparisonDisplayed},isKeyAllowed:function(d,b){retval=false;var a;if(d==8||d==0){retval=true}else{for(var c=0;c<b.length;c++){a=b.charCodeAt(c);if(a==d){retval=true;break}}}return retval},getField:function(b,c){var a=null;if(b.elements[c]){a=b.elements[c]}else{if(yav.get(c)){a=yav.get(c)}}return a},get:function(a){return document.getElementById(a)},unformatNumber:function(b){var a=b.replace(yav_config.THOUSAND_SEP,"");a=a.replace(yav_config.DECIMAL_SEP,".");return a},deleteInline:function(a){if(a.indexOf("__inline__")==-1){return a}else{return a.substring(0,a.indexOf("__inline__"))}},addEvent:function(c,b,a){if(c.addEventListener){c.addEventListener(b,a,false);return true}else{if(c.attachEvent){c["on"+b]=a}else{c["on"+b]=a}}},call:function(c,b,a){var d=document.forms[yav.formEvt].elements[c];addEvent(d,b,a)}};Function.prototype.bindAsEventListener=function(b){var a=this;return function(c){return a.call(b,c||window.event)}};
var yav_config={inputhighlight:true,multipleclassname:true,inputclasserror:"error",inputclassnormal:"normal",innererror:"inline-error",innerhelp:"inline-help",errorsdiv:"errors",debugmode:false,trimenabled:true,DECIMAL_SEP:".",THOUSAND_SEP:",",DATE_FORMAT:"dd-MM-yyyy",alphabetic_regex:"^[A-Za-z]*$",alphanumeric_regex:"^[A-Za-z0-9]*$",alnumhyphen_regex:"^[A-Za-z0-9-_]*$",alnumhyphenat_regex:"^[A-Za-z0-9-_@]*$",alphaspace_regex:"^[A-Za-z0-9-_ \n\r\t]*$",email_regex:"^(([0-9a-zA-Z]+[-._+&])*[0-9a-zA-Z]+@([-0-9a-zA-Z]+[.])+[a-zA-Z]{2,6}){0,1}$",RULE_SEP:"|",HEADER_MSG:"Datos no v�lidos:",FOOTER_MSG:"por favor, int&eacute;ntelo otra vez.",DEFAULT_MSG:"el dato no es v�lido.",REQUIRED_MSG:"Campo requerido",ALPHABETIC_MSG:"{1} no es v�lido. Caracteres permitidos: A-Za-z",ALPHANUMERIC_MSG:"{1} no es v�lido. Caracteres permitidos: A-Za-z0-9",ALNUMHYPHEN_MSG:"Caracter no v�lido. Se permite: A-Za-z0-9-_",ALNUMHYPHENAT_MSG:"{1} no es v�lido. Caracteres permitidos: A-Za-z0-9-_@",ALPHASPACE_MSG:"{1} no es v�lido. Caracteres permitidos: A-Za-z0-9-_espacio",MINLENGTH_MSG:"Debe tener {2} caracteres m�nimo",MAXLENGTH_MSG:"{1} debe tener como mucho {2} caracteres.",NUMRANGE_MSG:"{1} debe ser un n&uacute;mero en el intervalo {2}.",DATE_MSG:"{1} no es una fecha usando el formato dd-MM-yyyy.",NUMERIC_MSG:"{1} debe ser un n�mero.",INTEGER_MSG:"{1} debe ser un n�mero entero.",DOUBLE_MSG:"{1} debe ser un n�mero decimal.",REGEXP_MSG:"{1} no es v�lido. El formato permitido es {2}.",EQUAL_MSG:"{1} tiene que ser igual que {2}.",NOTEQUAL_MSG:"{1} no tiene que ser igual que {2}.",DATE_LT_MSG:"{1} tiene que ser anterior a {2}.",DATE_LE_MSG:"{1} tiene que ser anterior o igual a {2}.",EMAIL_MSG:"Direcci�n de email no v�lida",EMPTY_MSG:"{1} debe ser vacio."};